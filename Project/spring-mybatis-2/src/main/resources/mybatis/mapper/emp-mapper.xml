<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.dao.EmpDao">

	<insert id="insert" >
		insert into EMP (ename, job, sal) values (#{ename},#{job},#{sal})
		
		<selectKey order="AFTER" keyProperty="empno" resultType="int" >
			select LAST_INSERT_ID() as empno
		</selectKey>
	</insert>
	
	<update id="update">
		update EMP set ename=#{ename}, job=#{job}, sal=#{sal} where empno=#{empno}
	</update>
	
	<delete id="delete">
		delete from EMP where empno= #{empno}
	</delete>

	<select id="findAll" resultMap= "empRowMapper">

		select * from emp order by empno asc
	</select>


	<select id="count" resultType="int">
		select count(*) from emp
	</select>
	
	<select id="findOne" resultType="Emp">
		select * from emp where empno=#{empno}
	</select>

	<resultMap type="Emp" id="empRowMapper">
		<result property="empno" column="empno"/>
		<result property="ename" column="ename"/>
		<result property="job" column="job"/>
		<result property="sal" column="sal"/>
	</resultMap>
	
	<!-- 
	 	select * from emp 
		where empno between #{start} and #{end}
		order by empno asc 
		
		select * from emp 
      	where empno >= #{start} and empno <= #{end}
      	order by empno asc 
		대신 >,< 기호 사용 시 에러가 발생한다.
		
		해결 방법 2 가지 
		1. 치환기호를 사용한다.
			select * from emp 
      		where empno &gt;= #{start} and empno *lt;= #{end}
      		order by empno asc 
      		
		2. CDATA Section 구문으로 감싼다. 범위안에 태그가 존재하지 않는다는 뜻 
	 -->
	 <select id="findStartEnd" resultMap="empRowMapper">
      select * from emp
      <![CDATA[ 
      where empno >= #{start} and empno <= #{end}
      order by empno asc 
      ]]>
    </select>

	<select id="findSkipLimit" resultMap="empRowMapper">
      select * from emp order by empno asc limit #{skip}, #{limit}
    </select>
   
    <select id="findPageSize" resultMap="empRowMapper">
      select * from emp order by empno asc limit #{skip}, #{limit}
    </select>
    
    
</mapper>